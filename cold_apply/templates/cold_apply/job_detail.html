{% extends 'base_app.html' %}
{% load tz %}
{% get_current_timezone as TIME_ZONE %}

{% block breadcrumbs %}
    {% breadcrumb 'Pipeline' 'cold_apply:index' %}
    {% breadcrumb object.participant.full_name 'cold_apply:participant_detail' object.participant_id %}
    {% breadcrumb object.title|truncatechars:25 %}
{% endblock breadcrumbs %}

{% block content %}

    <table class="table">
        <tr>
            <th>Company</th>
            <th>Title</th>
        </tr>
        <tr>
            <td><a href="{% url 'cold_apply:update_company' object.company_id %}" target="_blank"> {{ object.company }}</a></td>
            <td><a href="{% url 'cold_apply:update_title' object.title_id %}" target="_blank"> {{ object.title }}</a></td>
        </tr>
    </table>
    <table class="table">
        <tr>
            <th>Status</th>
            <th>Status Reason</th>
            <th>Last Updated</th>
            <th>Last Updated By</th>
        </tr>
        <tr>
            <td>{{ object.status }}</td>
            <td>{{ object.status_reason }}</td>
            <td>{{ object.updated_at|date }}</td>
            <td>{{ object.updated_by }}</td>
        </tr>
    </table>
    {% if keywords %}
    <h2 class="sub-header">Keywords</h2>
    <table class="table table-stribed">
        <thead>
        <tr>
            <th>Unigrams</th>
            <th>Bigrams</th>
            <th>Trigrams</th>
        </tr>
        </thead>
        <tbody>
        <tr>
            <td>
                <ol>
                    {% for keyword in keywords %}
                        <li>{{ keyword.unigram }}</li>
                    {% endfor %}
                </ol>
            </td>
            <td>
                <ol>
                    {% for keyword in keywords %}
                        <li>{{ keyword.bigram }}</li>
                    {% endfor %}
                </ol>
            </td>
            <td>
                <ol>
                    {% for keyword in keywords %}
                        <li>{{ keyword.trigram }}</li>
                    {% endfor %}
                </ol>
            </td>
        </tr>
        </tbody>
    </table>
    {% endif %}
    <div class="row py-3">
        <div class="col">
            <h3>Actions</h3>
            <a class="btn btn-primary" href="{% url 'cold_apply:refresh_keywords' object.id %}">Refresh
                Keywords</a>
            <a class="btn btn-primary" href="{% url 'cold_apply:configure_tailored_resume'  job_pk=object.id %}" target="_blank">Tailor Resume</a>
            <a class="btn btn-primary" href="{% url 'cold_apply:update_job' object.id %}?from={{request.path}}">Edit Job</a>
        </div>
    </div>
    <div class="row py-3">
        <div class="col">
            <h3>Description</h3>
            <p style="white-space: pre-wrap;">{{ object.description }}</p>
        </div>
    </div>
    <div class="row py-3">
        <h3>Application Link</h3>
        <div class="col">
            <a href="{{object.application_link}}">{{ object.application_link }}</a>
        </div>
    </div>
    <div class="row py-3">
        <h3>Navigation</h3>
        <div class="col">
            <a class="btn btn-primary" href="{% url 'cold_apply:participant_detail' object.participant.id %}">Back to
                Participant Detail</a>
            <a class="btn btn-primary" href="{% url 'cold_apply:index' %}">Back to Pipeline</a>
        </div>
    </div>
{% endblock %}